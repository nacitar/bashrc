#!/bin/bash

# exit if no library path specified
[ -d "$NX_LIBRARY_PATH" ] || return

if [ -r /etc/profile ] then
    source /etc/profile
fi
for NX_TEMPVAR in /etc/{bash/bashrc,bash.bashrc,bashrc}
do
    if [ -r "$NX_TEMPVAR" ]; then
        source "$NX_TEMPVAR"
        break  # only the first one found
    fi
done
# directories to add to path, in reverse order of priority; the rightmost/last entry will come first
for NX_TEMPVAR in /opt/bin /opt/sbin /bin /sbin /usr/bin /usr/sbin /opt/local/bin /opt/local/sbin /usr/local/bin /usr/local/sbin
do
    # if it exists and isn't already in PATH
    if [[ -d "$NX_TEMPVAR" && ! "$PATH" =~ (^|:)$NX_TEMPVAR/?(:|$) ]]; then 
        export PATH="$NX_TEMPVAR:$PATH"
    fi
done
# add home locations even if they don't exist
export PATH="$HOME/bin:$PATH"
export LD_LIBRARY_PATH="$HOME/lib:$LD_LIBRARY_PATH"

# determine if in a chroot
export NX_CHROOT="$debian_chroot"
if [ -z "$NX_CHROOT" ] && [ -r '/etc/debian_chroot' ]; then
	export NX_CHROOT="$(cat /etc/debian_chroot)"
fi

# source local version, if present
for NX_TEMPVAR in "$NX_LIBRARY_PATH/local/environment.d"/*
do
	if [ -r "$NX_TEMPVAR" ]; then
        source "$NX_TEMPVAR"
    fi
done

# less variable pollution
unset NX_TEMPVAR

